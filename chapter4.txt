this is chapter 4 on my main branch